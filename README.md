# -pbuffer_lpszAddressString-
             $nAdapter += 1             ReDim $aResult[$nAdapter][$nColumns]              ;Unicast address(es)             $pUnicastAddress = DllStructGetData($tIP_ADAPTER_ADDRESSES, "FirstUnicastAddress")             $tIP_ADAPTER_UNICAST_ADDRESS = DllStructCreate($tagIP_ADAPTER_UNICAST_ADDRESS, $pUnicastAddress)             If Not $iFamily Then Local $aAddresses[0], $iCounter = -1              Do                 ;write the PREFERRED address for this adapter, it writes both IPV4 and IPV6 preferred addresses in an array if $iFamily == 0                 If DllStructGetData($tIP_ADAPTER_UNICAST_ADDRESS, "DadState") == $IpDadStatePreferred Then                     $plpSockaddr = DllStructGetData($tIP_ADAPTER_UNICAST_ADDRESS, "AddresslpSockaddr")                     $iSockaddrLength = DllStructGetData($tIP_ADAPTER_UNICAST_ADDRESS, "AddressiSockaddrLength")                     $aRet = DllCall($hWs2_32, "int", "WSAAddressToString", "ptr", $plpSockaddr, "int", $iSockaddrLength, "ptr", Null, "byte*", Null, "dword*", 0)                     If @error Then                         DllClose($hWs2_32)                         Return SetError(3, 0, 0)                     EndIf                      $tbuffer_lpszAddressString = DllStructCreate("wchar[" &amp; $aRet[5] &amp; "]")                     $pbuffer_lpszAddressString = DllStructGetPtr($tbuffer_lpszAddressString)                     $aRet = DllCall($hWs2_32, "int", "WSAAddressToStringW", "ptr", $plpSockaddr, "int", $iSockaddrLength, "ptr", Null, "ptr", $pbuffer_lpszAddressString, "dword*", $aRet[5])                     If @error Then                         DllClose($hWs2_32)                         Return SetError(3, 0, 0)                     EndIf                      If $iFamily Then                         $aResult[$nAdapter - 1][0] = _WinAPI_GetString($pbuffer_lpszAddressString)                         If @error And @error &lt;> 10 Then                             DllClose($hWs2_32)                             Return SetError(4, 0, 0)                         EndIf                         ExitLoop                     Else                         $iCounter = UBound($aAddresses)                         ReDim $aAddresses[$iCounter + 1]                         $aAddresses[$iCounter] = _WinAPI_GetString($pbuffer_lpszAddressString)                         If @error And @error &lt;> 10 Then
